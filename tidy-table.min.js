"use strict";function TidyTable(i,a,n){void 0===n&&(n={});var l=this,c={enableCheckbox:!1,enableMenu:!1,reverseSortDir:!1,responsive:!1};function s(){var e,t=function(){var e=document.createElement("table");if(e.appendChild(function(){for(var e=document.createElement("thead"),o=document.createElement("tr"),r=a.columnTitles,i=l.sortOrder,t=function(t){var e,n=r[t],c=document.createElement("th");c.appendChild(document.createTextNode(n)),c.setAttribute("title",n),o.appendChild(c),l.selected===t&&(i=l.options.reverseSortDir?"desc"!==i&&i?(e="arrow-up","desc"):(e="arrow-down","asc"):"asc"!==i&&i?(e="arrow-up","asc"):(e="arrow-up","desc"),c.classList.add(e));c.addEventListener("click",function(e){l.sortOrder=l.selected===t?i:"asc",function(o,e){var r=a.sortByPattern;"function"!=typeof r&&(r=function(e){return null==e?void 0:e.replace(/\$|%|#/g,"")});var i="desc"===e?-1:1;a.columnValues.sort(function(e,t){var n=r(e[o]),c=r(t[o]);return isNaN(n)?[i*u(n,c)]>[i*u(c,n)]?-1:1:[i*function(e,t){return t-e}(n,c)]})}(e,i),l.selected=e,s()}.bind(null,t),!1)},n=0;n<r.length;n++)t(n);return e.appendChild(o),e}()),e.appendChild(function(){for(var e=document.createElement("tbody"),t=a.columnValues,n=0;n<t.length;n++){for(var c=document.createElement("tr"),o=0;o<t[n].length;o++){var r,i=t[n][o],l=document.createElement("td");l.appendChild(document.createTextNode(i)),l.setAttribute("title",i),c.appendChild(l),"function"==typeof(null==(r=a.postProcess)?void 0:r.column)&&a.postProcess.column(l)}e.appendChild(c)}return e}()),l.options.enableCheckbox)for(var t=e.querySelectorAll("tr"),n=0;n<t.length;n++){var c=r(),o=void 0;0===n?(o=document.createElement("th"),c.addEventListener("click",function(){d(t)})):(o=document.createElement("td"),c.addEventListener("click",function(e){d(t,e)}.bind(null,n),!1)),o.appendChild(c),t[n].insertBefore(o,t[n].firstChild)}return e}();"function"==typeof(null==(e=a.postProcess)?void 0:e.table)&&a.postProcess.table(t);var n=i.querySelector(".tidy-table table");n?n.parentNode.replaceChild(t,n):(l.options.enableMenu&&i.appendChild(function(e){var t,n=document.createElement("select");n.classList.add(e),n.addEventListener("change",function(){var e=a.menuOptions[this.value][1].callback;"function"==typeof e&&e(function(){for(var e=i.querySelectorAll("tbody > tr"),t=[],n=0;n<e.length;n++){var c=e[n].childNodes;if(c[0].firstChild.checked){for(var o=[],r=1;r<c.length;r++)o[r-1]=c[r].textContent;t.push(o)}}return t}()),this.value=0});for(var c=0;c<a.menuOptions.length;c++){var o=document.createElement("option");o.text=a.menuOptions[c][0],o.value=c,n.appendChild(o)}"function"==typeof(null==(t=a.postProcess)?void 0:t.menu)&&a.postProcess.menu(n);return n}("options")),i.classList.add("tidy-table"),i.appendChild(t)),c.responsive&&i.classList.add("responsive")}function r(){var e=document.createElement("input");return e.setAttribute("type","checkbox"),e}function d(e,t){for(var n,c=0;c<e.length;c++){var o=e[c],r=o.querySelector("input[type=checkbox]");if(t){if(0===c)continue;!0===r.checked?(o.classList.replace("check-off","check-on")||o.classList.add("check-on"),r.checked=!0):(o.classList.replace("check-on","check-off"),r.checked=!1)}else{if(0===c){n=r.checked;continue}n?(o.classList.replace("check-off","check-on")||o.classList.add("check-on"),r.checked=!0):(o.classList.replace("check-on","check-off"),r.checked=!1)}}}function u(e,t){return t<e?1:e<t?-1:0}return function(){l.options=Object.assign(c,n);var e=a.columnTitles,t=a.columnValues;if(!e.length||!t.length)throw new Error("Failed to initialize (missing settings)");s()}(),l}window.tidyTable=function(e,t,n){return new TidyTable(e,t,n)},"undefined"!=typeof module&&module.exports&&(module.exports=TidyTable);